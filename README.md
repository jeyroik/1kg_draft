# 1kg_draft

1kg -- Одна тысяча камней (1k gems).

Игра, реализованная с использованием движка `love2d` https://love2d.org/

# Архитектура

- `Game` главный класс, является точкой входа, инициализируется как глобальная переменная. Через этот класс транслируется управление всеми событиями `love2d`.
- `Screen` вся игра состоит из экранов. Экран представляет собой контейнер, который хранит данные и информацию о том, что нужно рендерить. 
 - Например, для игры крестики-нолики правильно будет сделать как минимум 2 экрана -- экран авторизации и экран самой игры.
- `Layer` слой экрана. Слои бывают двух типов: данные и представления. Слой данных у экранов один, а слоёв представления может быть сколько-угодно.
 - `LayerData` слой данных, используется для передачи информации внутри экрана.
 - `LayerView` слой представления, отвечает за рендер того или иного фрагмента экрана. Например, отдельные слои для доски и информации по игрокам.
- `Scene` сцена. В рамках одного экрана может быть сколько-угодно сцен. Сцены инкапсулируют в себя различные сценарии и эпизоды взаимодействия с экраном.
 - Например, на экране "Игра" (для крестиков-ноликов) может быть несколько сцен: вступление -- здесь происходит интерактивное обучение управлению игре, игра -- здесь происходит непосредственная игра, конец -- здесь считаются и отображаются результаты.
 - Сцена определяет, какие представления ей нужны.

1. При инициализации игры, `Game` на вход получает стартовую конфигурацию.
 - Начальный экран всегда называется `main`.
2. `Game` запускает инициализацию ресурсов (картинки, звуки и т.п) и текущего экрана.
 - С помощью `AssetImporter` можно группировать ресурсы по блокам, например, по экранам/сценам/т.п.
3. Экран запускает инициализацию слоя данных и текущей сцены.

Любое событие `love2d` проходит следующий путь:

- `game:event(args)` данный метод передаёт управление в экран:
- `screen:event(args)` данный метод передаёт управление в сцену:
- `scene:event(args)` данный метод уже и определяет логику события.

В любой части кода доступен общий контейнер игры - `game`, через который, при необходимости, можно получить доступ к любой информации на текущий момент игры.

Не рекомендуется использовать данный объект -- предпочтительнее воспользоваться локальными данными.

Единственный случай, когда использование `game` оправдано -- это для доступа к ресурсам.

## Базовый объект

Все сущности игры реализуют базовый класс `GameObject`, поэтому имеют единообразное поведение.

В конструктор все сущности принимают таблицу конфигурации.

# Структура

- `bootstrap.lua` файл загрузки, в `main.lua` подключать нужно только его.
- `components/` все компоненты игры.
- `components/game` базовые классы игры.
- `components/game/game` главный класс.
- `components/assets/assets` менеджер ресурсов и класс импорта ресурсов.
- `components/magic` импорт информации о магии и класс типа магии.
- `components/mutators` импорт информации о мутаторах и сами мутаторы. Мутатор -- это объект, модифицирующий игроков/поле при использовании умений (скилов).
- `components/screens` доступные экраны.
- `components/screens/layers` компоненты слоёв и базовые слои представления.
- `components/screens/scenes` компоненты сцены.
- `components/screens/{screen.name}` директория с компонентами конкретного экрана.
- `components/screens/{screen.name}/data` слой данных экрана.
- `components/screens/{screen.name}/scenes` сцены экрана.
- `components/screens/{screen.name}/scenes/{scene.name}` импорт ресурсов сцены и слои представления для сцены.
- `components/skills` компоненты умения и сами умения.
- `components/sources` компоненты ресурсов (ассетов).
- `components/resources` базовое состояние игры и вспомогательные ресурсы -- конфигурации и т.п.
- `components/vendor` сторонние библиотеки

